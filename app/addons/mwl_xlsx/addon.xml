<?xml version="1.0" encoding="UTF-8"?>
<addon scheme="3.0">
    <id>mwl_xlsx</id>
    <version>0.1.0</version>
    <priority>500</priority>
    <position>0</position>

    <!-- Устанавливать во всех редакциях с витриной -->
    <auto_install>MULTIVENDOR,ULTIMATE</auto_install>
    <default_language>en</default_language>

    <name>Media Lists</name>
    <description>Adds multiple media lists per user without core changes (hooks, own tables, UI on product buttons).</description>

    <uninstall>fn_mwl_xlsx_uninstall</uninstall>

    <!-- Установочные/деинсталляционные SQL -->
    <queries>
        <!-- install -->
        <item for="install"><![CDATA[
        CREATE TABLE IF NOT EXISTS `?:mwl_xlsx_lists` (
        `list_id` INT AUTO_INCREMENT PRIMARY KEY,
        `user_id` INT UNSIGNED NOT NULL DEFAULT 0,
        `session_id` VARCHAR(64) NOT NULL DEFAULT '',
        `name` VARCHAR(255) NOT NULL,
        `is_private` TINYINT(1) NOT NULL DEFAULT 0,
        `created_at` DATETIME NOT NULL,
        `updated_at` DATETIME NOT NULL
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
        ]]></item>

        <item for="install"><![CDATA[
        CREATE TABLE IF NOT EXISTS `?:mwl_xlsx_list_products` (
        `list_id` INT NOT NULL,
        `product_id` INT NOT NULL,
        `product_options` TEXT,
        `amount` INT NOT NULL DEFAULT 1,
        `timestamp` INT NOT NULL,
        PRIMARY KEY (`list_id`, `product_id`, `timestamp`)
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
        ]]></item>

        <item for="install"><![CDATA[
        CREATE TABLE IF NOT EXISTS `?:mwl_xlsx_templates` (
        `template_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
        `company_id` INT UNSIGNED NOT NULL DEFAULT 0,
        `name` VARCHAR(255) NOT NULL,
        `path` VARCHAR(255) NOT NULL,
        `size` INT UNSIGNED NOT NULL DEFAULT 0,
        `created_at` INT UNSIGNED NOT NULL,
        `updated_at` INT UNSIGNED NOT NULL,
        PRIMARY KEY (`template_id`),
        KEY `company_id` (`company_id`)
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8
        ]]></item>

        <!-- uninstall -->
        <item for="uninstall"><![CDATA[
        DROP TABLE IF EXISTS `?:mwl_xlsx_list_products`;
        ]]></item>

        <item for="uninstall"><![CDATA[
        DROP TABLE IF EXISTS `?:mwl_xlsx_lists`;
        ]]></item>
    </queries>


    <!-- Языковые переменные -->
    <languages>
        <item>
            <name>en</name>
            <values>
                <value id="mwl_xlsx.name">Media Lists</value>
                <value id="mwl_xlsx.description">Create and manage multiple media lists.</value>
                <value id="mwl_xlsx.wishlists">Media lists</value>
                <value id="mwl_xlsx.my_lists">My media lists</value>
                <value id="mwl_xlsx.new_list">New list…</value>
                <value id="mwl_xlsx.enter_list_name">Enter list name</value>
                <value id="mwl_xlsx.added"><![CDATA[Added to <a href="[list_url]">[list_name]</a>]]></value>
                <value id="mwl_xlsx.added_plain">Added to media list</value>
                <value id="mwl_xlsx.rename">Rename</value>
                <value id="mwl_xlsx.remove">Remove</value>
                <value id="mwl_xlsx.confirm_remove">Remove this list?</value>
                <value id="mwl_xlsx.add_all_to_wishlist">Add all to media list</value>
                <value id="mwl_xlsx.add_to_wishlist">Add to media list</value>
                <value id="mwl_xlsx.remove_from_list">Remove from list</value>
                <value id="mwl_xlsx.removed">Removed</value>
                <value id="mwl_xlsx.hide_price_for_guests">Hide price for unauthorized</value>
                <value id="mwl_xlsx.authorized_usergroups">Authorized user groups</value>
                <value id="mwl_xlsx.show_extra_button">Show extra button in list</value>
                <value id="mwl_xlsx.allowed_usergroups">User groups allowed for media lists</value>
                <value id="mwl_xlsx.login_to_view_price">Log in to view price</value>
                <value id="mwl_xlsx.max_list_items">Maximum items per list</value>
                <value id="mwl_xlsx.list_limit_reached">You cannot add more than [limit] items to a media list</value>
                <value id="mwl_xlsx.export_google">Export Google Sheets</value>
                <value id="mwl_xlsx.google_credentials">Google credentials (JSON)</value>
                <value id="mwl_xlsx.google_drive_folder_id">Google Drive folder ID (optional, Shared Drive supported)</value>
            </values>
        </item>
        <item>
            <name>ru</name>
            <values>
                <value id="mwl_xlsx.name">Несколько подборок</value>
                <value id="mwl_xlsx.description">Создание и управление несколькими подборками.</value>
                <value id="mwl_xlsx.wishlists">Подборки</value>
                <value id="mwl_xlsx.my_lists">Мои подборки</value>
                <value id="mwl_xlsx.new_list">Новая подборка…</value>
                <value id="mwl_xlsx.enter_list_name">Введите название подборки</value>
                <value id="mwl_xlsx.added"><![CDATA[Добавлено в <a href="[list_url]">[list_name]</a>]]></value>
                <value id="mwl_xlsx.added_plain">Добавлено в подборку</value>
                <value id="mwl_xlsx.rename">Переименовать</value>
                <value id="mwl_xlsx.remove">Удалить</value>
                <value id="mwl_xlsx.confirm_remove">Удалить эту подборку?</value>
                <value id="mwl_xlsx.add_all_to_wishlist">Добавить все в подборку</value>
                <value id="mwl_xlsx.add_to_wishlist">Добавить в подборку</value>
                <value id="mwl_xlsx.remove_from_list">Удалить из подборки</value>
                <value id="mwl_xlsx.removed">Удалено</value>
                <value id="mwl_xlsx.hide_price_for_guests">Скрывать цену для неавторизованных</value>
                <value id="mwl_xlsx.authorized_usergroups">Группы пользователей авторизованных</value>
                <value id="mwl_xlsx.show_extra_button">Выводить кнопку extra в списке</value>
                <value id="mwl_xlsx.allowed_usergroups">Группы пользователей, которым разрешён доступ к mwl lists</value>
                <value id="mwl_xlsx.login_to_view_price">Войдите, чтобы увидеть цену</value>
                <value id="mwl_xlsx.max_list_items">Максимальное число товаров в подборке</value>
                <value id="mwl_xlsx.currencies_path">Путь к JSON валют</value>
                <value id="mwl_xlsx.list_limit_reached">Нельзя добавить более [limit] товаров в подборку</value>
                <value id="mwl_xlsx.export_google">Экспорт в Google Таблицы</value>
                <value id="mwl_xlsx.google_credentials">Учетные данные Google (JSON)</value>
                <value id="mwl_xlsx.google_drive_folder_id">ID папки Google Диска (необязательно, поддерживаются Общие диски)</value>
            </values>
        </item>
    </languages>

    <settings>
        <sections>
            <section id="general" name="General">
                <items>
                    <item id="hide_price_for_guests" type="checkbox">
                        <name>mwl_xlsx.hide_price_for_guests</name>
                        <value>N</value>
                    </item>
                    <item id="authorized_usergroups" type="selectbox" multiple="true">
                        <name>mwl_xlsx.authorized_usergroups</name>
                        <variants_function>fn_get_usergroups</variants_function>
                    </item>
                    <item id="show_extra_button" type="checkbox">
                        <name>mwl_xlsx.show_extra_button</name>
                        <value>Y</value>
                    </item>
                    <item id="allowed_usergroups" type="selectbox" multiple="true">
                        <name>mwl_xlsx.allowed_usergroups</name>
                        <variants_function>fn_get_usergroups</variants_function>
                    </item>
                    <item id="max_list_items" type="input">
                        <name>mwl_xlsx.max_list_items</name>
                        <value>50</value>
                    </item>
                    <item id="currencies_path" type="input">
                        <name>mwl_xlsx.currencies_path</name>
                        <value></value>
                    </item>
                    <item id="google_credentials" type="textarea">
                        <name>mwl_xlsx.google_credentials</name>
                    </item>
                    <item id="google_drive_folder_id" type="input">
                        <name>mwl_xlsx.google_drive_folder_id</name>
                    </item>
                </items>
            </section>
            <section id="notifications" name="mwl_xlsx.notifications">
                <items>
                    <item id="notify_via" type="selectbox">
                        <name>mwl_xlsx.notify_via</name>
                        <variants>
                            <item id="telegram">
                                <name>mwl_xlsx.notify_via_telegram</name>
                            </item>
                            <item id="email">
                                <name>mwl_xlsx.notify_via_email</name>
                            </item>
                        </variants>
                        <value>telegram</value>
                    </item>
                    <item id="telegram_bot_token" type="input">
                        <name>mwl_xlsx.telegram_bot_token</name>
                    </item>
                    <item id="telegram_chat_id" type="input">
                        <name>mwl_xlsx.telegram_chat_id</name>
                    </item>
                    <item id="notify_email" type="input">
                        <name>mwl_xlsx.notify_email</name>
                    </item>
                </items>
            </section>
        </sections>
    </settings>
</addon>
